#define UNDEFINED #define DEPRECATED(msg) [[deprecated(msg)]] #if defined(_MSC_VER) #define INLINE __inline #define FORCE_INLINE __forceinline #define NOINLINE __declspec(noinline) #define EXPECT(expr, value) (expr) #define HOT UNDEFINED #define COLD UNDEFINED #define NORETURN __declspec(noreturn) #define PURE UNDEFINED #define CONST UNDEFINED #define MALLOC UNDEFINED #define ALIGN(n) __declspec(align(n)) #define PACKED_START __pragma(pack(push, 1)) #define PACKED_END __pragma(pack(pop)) #define SECTION(name) __declspec(allocate(name)) #define FLATTEN UNDEFINED #define NO_SANITIZE(str) UNDEFINED #define EXPORT __declspec(dllexport) #define IMPORT __declspec(dllimport) #define WEAK UNDEFINED #define MAY_ALIAS UNDEFINED #elif defined(__GNUC__) || defined(__clang__) #define INLINE inline #define FORCE_INLINE inline __attribute__((always_inline)) #define EXPECT(expr, value) __builtin_expect((expr), (value)) #define HOT __attribute__((hot)) #define COLD __attribute__((cold)) #define NORETURN __attribute__((noreturn)) #define PURE __attribute__((pure)) #define CONST __attribute__((const)) #define MALLOC __attribute__((malloc)) #define NOINLINE __attribute__((noinline)) #define ALIGN(n) __attribute__((aligned(n))) #define PACKED_START __attribute__((packed)) #define PACKED_END UNDEFINED #define SECTION(name) __attribute__((section(name))) #define FLATTEN __attribute__((flatten)) #define NO_SANITIZE(str) __attribute__((no_sanitize(str))) #define EXPORT __attribute__((visibility("default"))) #define IMPORT UNDEFINED #define WEAK __attribute__((weak)) #define MAY_ALIAS __attribute__((may_alias)) #else //compiler unkown. #define INLINE inline #define FORCE_INLINE inline #define EXPECT(expr, value) (expr) #define HOT UNDEFINED #define COLD UNDEFINED #define NORETURN UNDEFINED #define PURE UNDEFINED #define CONST UNDEFINED #define MALLOC UNDEFINED #define NOINLINE UNDEFINED #define ALIGN(n) UNDEFINED #define PACKED UNDEFINED #define PACKED_START UNDEFINED #define PACKED_END UNDEFINED #define SECTION(name) UNDEFINED #define FLATTEN UNDEFINED #define NO_SANITIZE(str) UNDEFINED #define EXPORT UNDEFINED #define IMPORT UNDEFINED #define WEAK UNDEFINED #define MAY_ALIAS UNDEFINED #endif #define LIKELY(expr) EXPECT(expr, true) #define UNLIKELY(expr) EXPECT(expr, false)